import { HexagramData, LineInterpretation } from './types';

// The 8 Trigrams (Bagua) binary representation (Bottom -> Top)
// 0 = Yin, 1 = Yang
const TRIGRAMS: Record<string, string> = {
  '111': '天', // Qian
  '000': '地', // Kun
  '011': '兑', // Dui (Lake)
  '101': '离', // Li (Fire)
  '001': '震', // Zhen (Thunder)
  '110': '巽', // Xun (Wind)
  '010': '坎', // Kan (Water)
  '100': '艮', // Gen (Mountain)
};

interface HexagramRaw {
  name: string;
  desc: string;
  overview: string;
  career: string;
  love: string;
  strategy: string;
}

// Helper: Get Traditional Line Name (e.g., Position 1 Yang -> 初九)
const getLineName = (position: number, isYang: boolean): string => {
  const nature = isYang ? '九' : '六';
  if (position === 1) return `初${nature}`;
  if (position === 6) return `上${nature}`;
  return `${nature}${['二', '三', '四', '五'][position - 2]}`;
};

// Helper: Generate Zeng Shiqiang Style Interpretation based on Time & Position
// Logic: 
// 1 (初): 潜 (Hidden/Start) - Base level, difficult, wait.
// 2 (二): 见 (See/Appear) - Local leader, central, favorable.
// 3 (三): 惕 (Vigilant) - Transition, busy, dangerous, focus on past.
// 4 (四): 惧 (Fear/Leap) - Near king, minister, service, dangerous.
// 5 (五): 尊 (King) - The Ruler, central, peak success or responsibility.
// 6 (上): 亢 (Excess) - Advisor, retirement, regret, too high.
const getGeneralLineText = (position: number, isYang: boolean, hexName: string): { positionDesc: string, advice: string } => {
  switch (position) {
    case 1:
      return {
        positionDesc: '【时位：初难】处于事物的萌芽或基层阶段，地位未定，力量微弱。',
        advice: isYang 
          ? '阳气潜藏，如“潜龙勿用”。此时应韬光养晦，充实自己，不宜急于表现或行动。' 
          : '阴柔居下，基础薄弱。应安分守己，脚踏实地，切勿好高骛远，等待时机成熟。'
      };
    case 2:
      return {
        positionDesc: '【时位：二佳】处于下卦的中位，象征地方骨干或中层管理者，位置得当。',
        advice: isYang 
          ? '刚中之德，才华初显。利于进取，可得贵人赏识（利见大人），适合展现能力。' 
          : '柔顺中正，不仅有才，且能包容。适合配合上级，稳健发展，运势平顺。'
      };
    case 3:
      return {
        positionDesc: '【时位：三劳】处于下卦之极，将进上卦。位置尴尬，多劳多忧，极其凶险。',
        advice: isYang 
          ? '过刚不中，处于变革边缘。必须极其勤勉警惕（终日乾乾），虽有危险，但谨慎可无咎。' 
          : '阴柔不正，才不配位。不要逞强，不要追求虚名，应守住本分，否则容易招致羞辱。'
      };
    case 4:
      return {
        positionDesc: '【时位：四惧】进入上卦，伴君如伴虎。虽地位高，但最需小心谨慎。',
        advice: isYang 
          ? '刚居柔位，虽有能力但需收敛。如龙“或跃在渊”，进退需看时机，不可功高震主。' 
          : '柔顺得正，能妥善辅佐君王。只要顺应形势，尽心服务，就不会有灾祸。'
      };
    case 5:
      return {
        positionDesc: '【时位：五尊】全卦之主，君王之位。象征事物的顶峰或核心领导。',
        advice: isYang 
          ? '刚健中正，如“飞龙在天”。得位得势，利于施展抱负，造福众人，是大吉之象。' 
          : '阴居尊位，柔弱之主。应学会“垂拱而治”，重用贤能（如下方的阳爻），不可独断专行。'
      };
    case 6:
      return {
        positionDesc: '【时位：上亢】事物发展的终极，物极必反。象征退休的元老或局势的边缘。',
        advice: isYang 
          ? '亢龙有悔，进无可进。切忌傲慢固执，应知进退，及时引退或转变方向，否则必有悔恨。' 
          : '阴柔居极，虽然位高但无权。应保持低调，安享成果，避免卷入新的纷争。'
      };
    default:
      return { positionDesc: '', advice: '' };
  }
};

// 64 Hexagrams Detailed Mapping
export const HEXAGRAM_MAP: Record<string, HexagramRaw> = {
  '111111': {
    name: '乾为天',
    desc: '刚健中正，自强不息。',
    overview: '大吉之象。天行健，君子以自强不息。当前运势如日中天，但需注意物极必反。',
    career: '事业处于上升期，条件具备，可大展宏图。但切忌傲慢自大，应像龙一样，根据时机变化调整策略。',
    love: '感情关系稳固，由于过于刚强，容易出现互不相让的局面。男方应多些柔和。',
    strategy: '关键在于“时”与“位”。处于低位时要“潜龙勿用”，积蓄力量；处于高位时要警惕“亢龙有悔”，凡事留有余地。'
  },
  '000000': {
    name: '坤为地',
    desc: '厚德载物，柔顺包容。',
    overview: '吉。地势坤，君子以厚德载物。当前宜静不宜动，宜守不宜攻。',
    career: '适合配合、辅佐他人的工作，不宜独自领头创业。以诚待人，脚踏实地，通过积累获得成功，“利牝马之贞”。',
    love: '柔顺体贴，性格温和。感情发展顺利，但略显被动，需要对方主动引导。',
    strategy: '曾老强调“配合”的智慧。做人要像大地一样包容万物，不争功，不抢先，顺应形势自然能有所成就。'
  },
  '010001': {
    name: '水雷屯',
    desc: '万物始生，艰难险阻。',
    overview: '下下卦。屯者，难也。万物初生，必定艰难。目前处于创业或开端的困难期。',
    career: '创业初期，困难重重，方向不明。此时不宜轻举妄动，应建立根基，寻找贤能的帮手（利建侯）。',
    love: '感情处于混沌期，多有波折，尚未明朗。不宜操之过急，需耐心培养。',
    strategy: '面对困难不要轻言放弃，也不要盲目乱撞。要像植物破土一样，积蓄力量，盘旋而进。'
  },
  '100010': {
    name: '山水蒙',
    desc: '启蒙智慧，去昧求真。',
    overview: '中下卦。蒙昧不明之象。时机未到，智慧未开，如同被迷雾笼罩。',
    career: '经验不足，容易判断失误。应当虚心向长辈或专家请教（童蒙求我），切忌自作聪明。',
    love: '双方缺乏了解，沟通不畅，或存在单相思的情况。需要真诚沟通，消除误会。',
    strategy: '蒙卦启示教育的重要性。遇到问题不要乱猜，要通过学习和请教来“击蒙”。教育要趁早，且要严慈相济。'
  },
  '010111': {
    name: '水天需',
    desc: '守正待机，饮食宴乐。',
    overview: '中上卦。需者，待也。云在天上，雨未下，需要耐心等待时机。',
    career: '时机尚未成熟，急于求成必败。当前应积蓄力量，像等待下雨的农夫一样，利用这段时间修养身心。',
    love: '感情需要时间考验，不要急于确立关系。等待是最好的催化剂。',
    strategy: '等待不是消极怠工，而是“饮食宴乐”，保持乐观的心态和健康的体魄，以便机会来临时能抓得住。'
  },
  '111010': {
    name: '天水讼',
    desc: '慎争戒讼，止戈为武。',
    overview: '下下卦。争讼之象。意见不合，发生争执，若不妥善处理将导致官司口舌。',
    career: '与人合作易生分歧，利益分配不均。应防微杜渐，在事情开始前就把规则定好，避免后期的争执。',
    love: '容易发生口角，互不相让。应多做换位思考，退一步海阔天空。',
    strategy: '“作事谋始”，一开始就要把丑话说在前面。一旦发生争端，应寻求公正的第三方调解，不宜把事情做绝。'
  },
  '000010': {
    name: '地水师',
    desc: '行险而顺，容民畜众。',
    overview: '中上卦。师者，众也。兴师动众，出征之象。既有风险，也蕴含巨大的成功机会。',
    career: '由于竞争激烈，需要严明的纪律和强有力的领导（丈人吉）。适合团队作战，不宜单打独斗。',
    love: '感情复杂，可能面临多角关系或家长反对。需要坚定信念，排除万难。',
    strategy: '带兵打仗（管理团队）关键在于“正”。领导者必须公正无私，才能服众。用人要疑人不用，用人不疑。'
  },
  '010000': {
    name: '水地比',
    desc: '亲密比辅，协和万邦。',
    overview: '上上卦。比者，亲也。水附于地，相亲相爱，贵人相助之象。',
    career: '人际关系良好，有贵人提拔。适合寻求合作，建立联盟。要选择正确的合作伙伴，“比之匪人”则凶。',
    love: '两情相悦，关系和谐。适合确立关系或步入婚姻殿堂。',
    strategy: '良禽择木而栖。选择跟随谁、与谁合作至关重要。同时自己也要诚信待人，才能吸引他人来“比”。'
  },
  '110111': {
    name: '风天小畜',
    desc: '积德蓄力，未可大用。',
    overview: '中下卦。密云不雨之象。力量有限，只能做小规模的积蓄，暂时不能有大作为。',
    career: '时运未通，不宜推行大计划。应利用这段时间完善细节，处理小事，积少成多。',
    love: '感情出现小波折，沟通不畅，但不会导致破裂。需要耐心化解。',
    strategy: '小畜是蓄养力量。当外部环境不利时，要回到自身，修身养性。不要因为进展缓慢而焦虑，小步快走也是进。'
  },
  '111011': {
    name: '天泽履',
    desc: '脚踏实地，战战兢兢。',
    overview: '中上卦。履虎尾，不咥人。虽然行走在危险边缘，但只要小心谨慎，终能化险为夷。',
    career: '工作中有风险，伴君如伴虎。需要严格遵守礼仪规范，步步为营，切勿越界。',
    love: '关系中存在地位差异或性格冲突。要以礼相待，保持适当的距离感。',
    strategy: '礼教是保护自己的盔甲。在复杂的环境中，按照规矩办事，对人恭敬有礼，就能避免灾祸。'
  },
  '000111': {
    name: '地天泰',
    desc: '阴阳交泰，万物通畅。',
    overview: '上上卦。天地交而万物通。小往大来，吉亨。目前是运势最好的时期之一。',
    career: '上下沟通顺畅，团队凝聚力强。事业顺利，付出少而收获大。应抓住机遇，扩大规模。',
    love: '情投意合，天作之合。感情深厚，家庭和睦。',
    strategy: '“无平不陂，无往不复”。在顺境中要保持清醒，居安思危，防范泰极否来的自然规律。'
  },
  '111000': {
    name: '天地否',
    desc: '上下不交，闭塞不通。',
    overview: '下下卦。天地不交，万物不通。大往小来，运势陷入低谷。',
    career: '小人当道，君子受排挤。上下级隔阂深重，意见无法传达。此时应收敛才华，避免锋芒毕露（俭德辟难）。',
    love: '感情冷淡，缺乏沟通，甚至面临分居或分手的危机。',
    strategy: '在否运中，不要同流合污。要坚持自己的原则，虽然孤独，但内心要亨通。等待时局变化，否极终会泰来。'
  },
  '111101': {
    name: '天火同人',
    desc: '上下和同，与人同乐。',
    overview: '中上卦。同人于野，亨。与人和睦相处，志同道合，利于涉大川。',
    career: '利于团队合作，打破部门壁垒。要大公无私，团结一切可以团结的力量。',
    love: '关系公开透明，朋友圈交集多。感情发展顺利。',
    strategy: '求同存异是关键。要把眼光放长远，不要局限于小团体的利益（同人于宗，吝），要在这个大社会中寻找志同道合者。'
  },
  '101111': {
    name: '火天大有',
    desc: '顺天依时，大有收获。',
    overview: '上上卦。火在天上，光普照万物。盛大丰有之象，运势极佳。',
    career: '事业达到顶峰，资源丰富，人心归附。但要切记满招损，谦受益。',
    love: '感情丰富多彩，备受瞩目。需防范烂桃花。',
    strategy: '富有的最高境界是精神的富有。在拥有物质财富的同时，要遏恶扬善，顺天休命，做对社会有益的事。'
  },
  '000100': {
    name: '地山谦',
    desc: '内高外低，谦谦君子。',
    overview: '上上卦。山在地中，不仅有实力，而且懂得隐藏。谦卦是六爻皆吉的卦。',
    career: '越是身居高位，越要谦虚谨慎。通过让利、放权来获得更长久的支持。',
    love: '相敬如宾，互相尊重。以退为进，感情长久。',
    strategy: '谦虚不是虚伪，而是基于实力的内敛。只有把自己的杯子放低，别人的水（资源、智慧）才能流进来。'
  },
  '001000': {
    name: '雷地豫',
    desc: '顺以动之，快乐和悦。',
    overview: '中上卦。豫者，乐也。雷出地奋，顺应时势而动，必能获得快乐和成功。',
    career: '时机成熟，可以放手一搏。工作氛围轻松愉快，容易出成果。',
    love: '心情愉悦，感情甜蜜。适合约会、旅游，增进感情。',
    strategy: '快乐要适度，“乐而不淫”。在享受成功的同时，要居安思危，防止因为过度安逸而导致“冥豫”（沉迷享乐）。'
  },
  '011001': {
    name: '泽雷随',
    desc: '随时变通，顺势而为。',
    overview: '中中卦。随者，顺也。出门交有功。顺应形势，随和他人，可以获得成功。',
    career: '不要固执己见，要根据市场或环境的变化调整策略。跟随有能力的人或大趋势。',
    love: '随缘而聚。如果是男方，此时宜迁就女方。',
    strategy: '“随”不是盲从，而是择善而从。在原则问题上要坚持，在方法上要灵活。随时、随性、随缘。'
  },
  '100110': {
    name: '山风蛊',
    desc: '整饬弊乱，振疲起衰。',
    overview: '中下卦。蛊者，事也，腐败也。器皿久不用而生虫。内部出现问题，需要整顿。',
    career: '积弊已久，到了必须改革的时候。接手烂摊子虽然辛苦，但也是建功立业的好机会。',
    love: '感情出现裂痕，或被第三者插足。需要彻底沟通，清除隐患。',
    strategy: '“干父之蛊”。面对前人留下的问题，不要抱怨，要勇于承担并加以改良。改革前要先甲三日（考察），后甲三日（反馈）。'
  },
  '000011': {
    name: '地泽临',
    desc: '以上临下，教思无穷。',
    overview: '中上卦。临者，大也。阳气增长，大驾光临。运势逐渐走强。',
    career: '适合亲临一线，视察工作。领导者要深入基层，了解实情。',
    love: '主动出击，感情升温。',
    strategy: '“至于八月有凶”。在运势好的时候，要预见到未来可能的衰退，提前做好准备。管理要恩威并施。'
  },
  '110000': {
    name: '风地观',
    desc: '观瞻视察，下民归心。',
    overview: '中上卦。大观在上，顺而巽。与其行动，不如静观其变，分析局势。',
    career: '当前不宜大动干戈，应多做市场调研和观察。作为领导者，要注重自身形象，起到表率作用。',
    love: '双方都在观察对方，处于相互了解的阶段。',
    strategy: '观我生，观其生。既要反省自己，也要观察他人。通过观察自然规律来指导人类社会的生活（圣人以神道设教）。'
  },
  '101001': {
    name: '火雷噬嗑',
    desc: '刑法治狱，去邪归正。',
    overview: '中平卦。噬嗑，咬合也。口中有物，必须咬断才能合拢。象征通过强硬手段清除障碍。',
    career: '工作中遇到顽固的阻碍或小人。必须采取果断措施，恩威并施，消除障碍后才能顺利。',
    love: '感情中有误会或第三者阻碍，需要坦诚沟通，甚至发生争吵才能解决问题。',
    strategy: '治乱世用重典。面对违法乱纪或破坏规则的行为，不能手软，必须依法惩处，以儆效尤。'
  },
  '100101': {
    name: '山火贲',
    desc: '文饰光明，小利有攸往。',
    overview: '中上卦。贲者，饰也。夕阳无限好，只是近黄昏。重视外表的修饰，但要注意实质。',
    career: '适合从事文化、艺术、广告等需要包装的行业。表面光鲜，但要注意内部管理。',
    love: '注重形式和浪漫，感情生活丰富多彩。但要避免华而不实。',
    strategy: '“白贲无咎”。最高级的修饰是返璞归真。在注重外表的同时，更要注重内在的修养和实力的积累。'
  },
  '000001': {
    name: '山地剥',
    desc: '去旧生新，顺势而止。',
    overview: '下下卦。剥者，落也。五阴剥一阳，小人得势，君子困顿。',
    career: '形势非常不利，基础动摇。此时不宜进取，应韬光养晦，保存实力，等待时机。',
    love: '感情破裂，可能面临分离。',
    strategy: '“不利有攸往”。当大环境不利时，唯一的策略就是“止”。不要做无谓的牺牲，留得青山在，不怕没柴烧。'
  },
  '100000': {
    name: '地雷复',
    desc: '一阳来复，万物再生。',
    overview: '中上卦。复者，反也。剥极必复，黑暗过去，光明初现。',
    career: '低谷期已过，开始出现转机。虽然力量尚弱，但前途光明。适合重新开始，恢复旧业。',
    love: '破镜重圆，旧情复燃，或开始一段新的感情。',
    strategy: '复兴的关键在于“不远复”。一发现错误马上改正，不要走得太远。保护好初生的阳气（微弱的希望）。'
  },
  '111001': {
    name: '天雷无妄',
    desc: '真实无妄，合乎天理。',
    overview: '中上卦。无妄者，真诚也。天下雷行，物与无妄。只要心存正念，顺应天理，就会吉祥。',
    career: '脚踏实地，不走捷径，不存妄想。适合从事正当行业，投机取巧必败。',
    love: '真诚相待，没有虚假。感情纯真。',
    strategy: '“无妄之疾，勿药有喜”。如果自己行得正，遇到意外的灾祸也不用惊慌，顺其自然，灾祸会自动消除。'
  },
  '100111': {
    name: '山天大畜',
    desc: '刚健笃实，辉光日新。',
    overview: '上上卦。大畜者，积聚也。既积蓄财物，也积蓄道德和学问。',
    career: '实力雄厚，资源丰富。可以承担重任，大展宏图。利于涉大川（冒险、远行）。',
    love: '感情深厚，基础稳固。由于双方都很优秀，可能有些许阻碍，但终成眷属。',
    strategy: '“多识前言往行，以畜其德”。要不断学习前人的经验，丰富自己的内涵。同时要懂得止，适可而止。'
  },
  '100001': {
    name: '山雷颐',
    desc: '纯正以养，自求口实。',
    overview: '中平卦。颐者，养也。口角向下，如人咀嚼。关注饮食养生和言语谨慎。',
    career: '休养生息之时。要注意言语，祸从口出。工作上要自食其力。',
    love: '注重精神交流和生活照顾。',
    strategy: '“病从口入，祸从口出”。曾老特别强调饮食和言语的控制。养正气，不说废话、坏话。'
  },
  '011110': {
    name: '泽风大过',
    desc: '非常时期，非常手段。',
    overview: '中下卦。大过者，祸也。栋桡，房屋栋梁弯曲，压力过大。',
    career: '负担过重，超出了能力的极限。可能会犯大错误，或面临巨大的挑战。',
    love: '老夫少妻或老妻少夫之象（枯杨生稊）。感情非同寻常，压力大。',
    strategy: '“独立不惧，遁世无闷”。在非常时期，要有非凡的勇气和定力。如果无法支撑，要懂得及时撤退或寻求外援。'
  },
  '010010': {
    name: '坎为水',
    desc: '重重险陷，习教事功。',
    overview: '下下卦。水流而不盈，行险而不失其信。困难一个接一个，处于人生的低谷。',
    career: '环境险恶，进退两难。切勿轻举妄动，应沉着应付，等待时机。',
    love: '感情波折，充满猜疑和不安。',
    strategy: '习坎。要把困难当作磨练意志的磨刀石。水滴石穿，保持信心（维心亨），在这个过程中学习和成长。'
  },
  '101101': {
    name: '离为火',
    desc: '附丽光明，照耀四方。',
    overview: '中上卦。离者，丽也。火必须附着在物体上燃烧。象征依附关系和光明。',
    career: '运势火红，但必须依附于正当的平台或领导。不能脱离集体而独立存在。',
    love: '热情如火，但来得快去得也快。需要理性的约束。',
    strategy: '人必须要有所依附（如依附正道、依附贤人）。同时要像养牛一样柔顺（畜牝牛吉），保持内心的柔和与中正。'
  },
  '011100': {
    name: '泽山咸',
    desc: '虚受人言，感应道交。',
    overview: '中上卦。咸者，感也。山上有泽，以虚受人。象征心灵感应和沟通。',
    career: '人际关系和谐，适合谈判、公关。通过真诚的感应来打动他人。',
    love: '两情相悦，心有灵犀。是求婚、恋爱的极佳卦象。',
    strategy: '感应的关键在于“无心”。如果是为了利益去感应（有心），就是交换。要虚心，才能接受别人的建议和帮助。'
  },
  '001110': {
    name: '雷风恒',
    desc: '立不易方，长久不息。',
    overview: '中上卦。恒者，久也。雷风相与，长久之道。',
    career: '适合守成，不宜频繁变动。坚持现有的方向，持之以恒必有成就。',
    love: '感情稳定，细水长流。老夫老妻的相处模式。',
    strategy: '“人贵有恒”。但恒不是死板，而是“日新其德”。在变动中保持原则不变，在不变中寻求方法的新意。'
  },
  '111100': {
    name: '天山遁',
    desc: '退避隐居，不仅而善。',
    overview: '中下卦。遁者，退也。阴长阳消，小人道长，君子道消。',
    career: '时局不利，受到排挤。此时不宜硬碰硬，应该激流勇退，明哲保身。',
    love: '落花有意，流水无情。对方有退缩之意。',
    strategy: '“不恶而严”。退让时不要恶语相向，要保持尊严。退是为了更好的进，利用这段时间充实自己。'
  },
  '001111': {
    name: '雷天大壮',
    desc: '刚壮隆盛，非礼弗履。',
    overview: '中上卦。大壮，阳气大盛。运势强劲，但容易因为冲动而犯错。',
    career: '事业发展迅猛，但要防止盲目扩张。切忌仗势欺人或过度自信。',
    love: '过于强势，缺乏柔情。需要注意沟通方式。',
    strategy: '“非礼弗履”。越是强壮的时候，越要遵守礼法。要用“罔”来约束自己，不要像公羊撞篱笆一样，进退不得。'
  },
  '101000': {
    name: '火地晋',
    desc: '旭日东升，君子昭德。',
    overview: '中上卦。晋者，进也。日出地上，光明普照。运势蒸蒸日上。',
    career: '得到晋升、提拔的机会。才华得到施展，受到领导赏识。',
    love: '感情明朗，关系更进一步。',
    strategy: '“自昭明德”。在顺境中，要更加彰显自己的美德。利用这个机会多做贡献，回报社会。'
  },
  '000101': {
    name: '地火明夷',
    desc: '晦而转明，内难而能正。',
    overview: '下下卦。明夷，光亮受损。日入地中，黑暗时刻。',
    career: '才华被埋没，受到打压。此时要收敛光芒，装糊涂（箕子之明），以免招致更大的祸患。',
    love: '感情受挫，内心痛苦。需要时间疗伤。',
    strategy: '“利艰贞”。在最黑暗的时候，要坚守正道。外表顺从，内心坚定。不要暴露自己的聪明，用晦暗来保护光明。'
  },
  '110101': {
    name: '风火家人',
    desc: '言有物行，治家有道。',
    overview: '中上卦。风自火出，家人内助。强调家庭和内部建设的重要性。',
    career: '攘外必先安内。先把内部团队建设好，再去拓展外部市场。',
    love: '家庭和睦，婚姻幸福。男主外女主内（或分工明确）。',
    strategy: '“正家而天下定”。做人要言行一致（言有物，行有恒）。管理公司要像管理家庭一样，既要有爱，又要有规矩。'
  },
  '101011': {
    name: '火泽睽',
    desc: '二女同居，其志不同。',
    overview: '下下卦。睽者，乖异也。水火不容，意见分歧。',
    career: '人心涣散，合作破裂。要注意求同存异，处理好人际矛盾。',
    love: '性格不合，争吵不断。甚至反目成仇。',
    strategy: '在分裂中寻找结合点（小事吉）。大事难成，但小事还可以合作。要把不同的力量结合起来（异中求同）。'
  },
  '010100': {
    name: '水山蹇',
    desc: '险阻在前，反身修德。',
    overview: '下下卦。蹇者，难也。前有险（水），后有阻（山）。进退维谷。',
    career: '道路不通，困难重重。不宜盲目行动，应该停下来反省自己（反身修德）。',
    love: '感情受阻，如同隔着千山万水。',
    strategy: '“利见大人”。遇到过不去的坎，要寻求高人的指点。既然此路不通，不如退回来修养品德，等待时机。'
  },
  '001010': {
    name: '雷水解',
    desc: '赦过宥罪，险难消除。',
    overview: '中上卦。解者，散也。春雷发动，雨水降临，万物复苏。困难开始化解。',
    career: '危机解除，压力释放。宜抓住机会，迅速行动，解决遗留问题。',
    love: '误会消除，重归于好。',
    strategy: '“有攸往，夙吉”。解决问题要快，不要拖泥带水。同时要宽容别人的过失（赦过宥罪），让大家轻装上阵。'
  },
  '100011': {
    name: '山泽损',
    desc: '惩忿窒欲，损下益上。',
    overview: '中平卦。损者，减也。损下益上，为了长远利益而牺牲局部利益。',
    career: '目前的投入是为了未来的产出。可能需要暂时减少开支或精简人员。',
    love: '需要付出和牺牲，多为对方考虑。',
    strategy: '“惩忿窒欲”。控制自己的脾气和欲望。损不是坏事，而是通过减少不必要的支出来增加内涵。损之始，益之终。'
  },
  '110001': {
    name: '风雷益',
    desc: '见善则迁，有过则改。',
    overview: '上上卦。益者，增也。损上益下，施惠于民。运势大好。',
    career: '得到外界的帮助，事业大发展。利于推行新政，造福众人。',
    love: '感情升温，由于互相帮助而更加亲密。',
    strategy: '“见善则迁，有过则改”。真正的受益是道德的提升。当你有能力时，要多帮助别人，这样福报会更多。'
  },
  '011111': {
    name: '泽天夬',
    desc: '决去奸邪，施禄及下。',
    overview: '中上卦。夬者，决也。五阳决一阴，正义战胜邪恶。需要果断决策。',
    career: '面临重大的抉择或清除内部隐患。要公开、公正地处理，不能私下解决。',
    love: '感情上要有决断，结束不健康的关系，或者痛快地表白。',
    strategy: '“健而说，决而和”。虽然要果断处理小人，但方式要温和，不要激起对方的极端反抗。要公开宣布其罪状。'
  },
  '111110': {
    name: '天风姤',
    desc: '阴阳相遇，不可与长。',
    overview: '中下卦。姤者，遇也。一阴遇五阳，阴气初生。不期而遇。',
    career: '可能会遇到意外的诱惑或小人的侵袭。要防微杜渐，不要被表面的繁荣迷惑。',
    love: '容易发生一夜情或不正当的关系（勿用取女）。需保持清醒。',
    strategy: '“品物咸章”。万物相遇是自然的，但要辨别好坏。对于刚萌芽的坏事，要及时制止，不能让它壮大。'
  },
  '011000': {
    name: '泽地萃',
    desc: '聚集精英，修除兵器。',
    overview: '中上卦。萃者，聚也。泽在地上，水聚于泽。人才、物资聚集之象。',
    career: '业务繁忙，客户盈门。适合开会、团建、招募人才。但也要防止鱼龙混杂。',
    love: '追求者众，或者感情深厚。',
    strategy: '聚集之后要防范意外（修戎）。人多了，矛盾也多，需要建立制度来管理。要用诚意（假有庙）来凝聚人心。'
  },
  '000110': {
    name: '地风升',
    desc: '积小成大，顺势而升。',
    overview: '上上卦。升者，进也。树木在地下生长，逐渐破土而出。运势稳步上升。',
    career: '适合晋升、提拔、学业进步。要像树木一样，扎根稳固，然后慢慢向上长。',
    love: '感情稳步发展，逐步走向成熟。',
    strategy: '“南征吉”。向着光明的方向发展。升迁的过程中不要急躁，要顺势而为，积小成大。'
  },
  '011010': {
    name: '泽水困',
    desc: '致命遂志，处困而亨。',
    overview: '下下卦。困者，危也。泽无水，困顿之象。才智无法施展。',
    career: '陷入绝境，资金断裂或无人支持。此时说什么都没人信（尚口乃穷）。',
    love: '感情陷入僵局，痛苦不堪。',
    strategy: '“致命遂志”。在困境中，只有豁出性命去实现志向，才能通达。君子固穷，小人穷斯滥矣。守住底线。'
  },
  '010110': {
    name: '水风井',
    desc: '养人不穷，井德之地。',
    overview: '中平卦。井者，养也。木入水出，井养而不穷。象征资源的开发和共享。',
    career: '工作平稳，如同一口井，为他人提供服务。要注意维护设施（井泥不食），更新知识。',
    love: '平淡而长久，相濡以沫。',
    strategy: '井德在于“改邑不改井”。无论环境怎么变，做人的根本不能变。要不断挖掘自己的潜力，并无私地分享给他人。'
  },
  '011101': {
    name: '泽火革',
    desc: '顺天应人，变革鼎新。',
    overview: '中上卦。革者，变也。水火相息，变革之象。旧的不去，新的不来。',
    career: '必须进行彻底的改革或转型。时机已经成熟，不能犹豫。',
    love: '旧情结束，新恋情开始。或者改变相处模式。',
    strategy: '“大人虎变”。改革要像老虎换毛一样，纹理清晰，焕然一新。改革必须顺应民心，且要把握好时机（已日乃孚）。'
  },
  '101110': {
    name: '火风鼎',
    desc: '正位凝命，取新去故。',
    overview: '中上卦。鼎者，定也。革故鼎新。鼎是重器，象征权力和稳重。',
    career: '事业进入稳固期，或者建立新的基业。适合三人合作（三足鼎立）。',
    love: '因缘际会，关系稳固。',
    strategy: '“正位凝命”。摆正自己的位置，完成自己的使命。鼎要以此来煮食物祭祀上帝和养育圣贤，要有大格局。'
  },
  '001001': {
    name: '震为雷',
    desc: '临危不乱，从容不迫。',
    overview: '中平卦。震者，动也。震惊百里，不丧匙鬯。动荡之中考验人的定力。',
    career: '由于突发事件而产生变动。虽然声势浩大，但只要镇定自若，就不会有大损失。',
    love: '争吵激烈，或发生令人震惊的变故。',
    strategy: '“恐惧修省”。听到雷声要心存敬畏，反省自己。在危机面前，保持从容淡定，是领导者必备的素质。'
  },
  '100100': {
    name: '艮为山',
    desc: '动静失时，止其所止。',
    overview: '中下卦。艮者，止也。两山重叠，寸步难行。宜止不宜进。',
    career: '事业受阻，无法推进。此时应该停下来，做好本职工作（思不出其位）。',
    love: '受阻，无法沟通。各自固守己见。',
    strategy: '“时止则止，时行则行”。止不是永远不动，而是该停的时候停。要止欲、止念，控制自己的内心，才能获得平静。'
  },
  '110100': {
    name: '风山渐',
    desc: '循序渐进，积善成德。',
    overview: '上上卦。渐者，进也。山上有木，逐渐长高。女归吉。',
    career: '稳步上升，不可急功近利。按照步骤一步步来，基础打得越牢，成就越大。',
    love: '按照传统礼仪（纳采、问名等）一步步发展，婚姻美满。',
    strategy: '“居贤德善俗”。要改变风俗习惯，必须循序渐进。做任何事都要有耐心，慢工出细活。'
  },
  '001011': {
    name: '雷泽归妹',
    desc: '永终知敝，由于情欲。',
    overview: '下下卦。归妹，嫁妹也。悦以动，容易因为冲动而做出错误的选择。',
    career: '位置颠倒，德不配位。不要被眼前的利益诱惑，要考虑长远的后果。',
    love: '畸形的恋爱，或者为了欲望而结合，结局往往不好。',
    strategy: '“永终知敝”。在开始的时候就要想到结局的弊端。如果动机不纯，结果一定不好。要控制情欲，回归理性。'
  },
  '001101': {
    name: '雷火丰',
    desc: '丰大光明，折狱致刑。',
    overview: '上上卦。丰者，大也。如日中天，丰衣足食。但丰盛到极点就是衰败的开始。',
    career: '业绩辉煌，达到顶峰。此时要明察秋毫，果断处理问题（折狱）。',
    love: '感情热烈，如火如荼。',
    strategy: '“日中则昃”。要明白盛极必衰的道理，不要因为丰盛而骄傲。要在光辉的时候，像太阳一样普照大地，公正无私。'
  },
  '101100': {
    name: '火山旅',
    desc: '明慎用刑，都不留狱。',
    overview: '中下卦。旅者，客也。山上有火，火势蔓延，居无定所。',
    career: '不安定，经常出差或变动工作。作为外来者，要小心谨慎，不要得罪地头蛇。',
    love: '聚少离多，由于不稳定而产生变数。',
    strategy: '旅客要有旅客的觉悟。不要反客为主，要入乡随俗。得过且过，保持低调，保护好自己。'
  },
  '110110': {
    name: '巽为风',
    desc: '申命行事，柔皆顺乎刚。',
    overview: '中上卦。巽者，入也。风无孔不入。顺从，谦逊。',
    career: '利于通过渗透、沟通来解决问题。要反复申明命令（申命行事），确保执行到位。',
    love: '顺从对方，耳鬓厮磨。但也可能优柔寡断。',
    strategy: '“利见大人”。顺从不是没有原则，而是顺从天理和贤人。通过潜移默化的方式去影响别人，比强硬的手段更有效。'
  },
  '011011': {
    name: '兑为泽',
    desc: '朋友讲习，欣悦和乐。',
    overview: '中上卦。兑者，悦也。两泽相连，互相滋润。快乐、喜悦。',
    career: '沟通顺利，谈判愉快。适合服务业或娱乐业。',
    love: '甜言蜜语，两情相悦。',
    strategy: '“君子以朋友讲习”。快乐要建立在共同学习和进步的基础上。独乐乐不如众乐乐。要注意防范口蜜腹剑。'
  },
  '110010': {
    name: '风水涣',
    desc: '拯救涣散，设庙祭祀。',
    overview: '中下卦。涣者，散也。风吹水面，波纹涣散。人心离散之象。',
    career: '组织松散，由于缺乏凝聚力而面临危机。此时需要建立共同的信仰或目标（立庙）。',
    love: '感情疏远，甚至分离。',
    strategy: '“享于帝立庙”。当人心散了，要用宗教、文化或企业精神来重新凝聚大家。利用舟楫之利（工具、方法）涉险过河。'
  },
  '010011': {
    name: '水泽节',
    desc: '制度节约，不伤财害民。',
    overview: '中上卦。节者，止也。泽上有水，水多了要溢出来，必须设堤坝节制。',
    career: '制定规则，控制成本，节约资源。不宜盲目扩张，要懂得适可而止。',
    love: '发乎情，止乎礼。感情要有节制，不能放纵。',
    strategy: '“苦节不可贞”。节约是好事，但不能太苦，否则没人能坚持。制度要人性化，既要有约束，又要有适度的自由。'
  },
  '110011': {
    name: '风泽中孚',
    desc: '诚信立身，虚心纳谏。',
    overview: '上上卦。孚者，信也。中心诚信，如孵卵之信。诚信能感通万物。',
    career: '信誉良好，合同顺利。以诚待人，即使是微小的生物（豚鱼）也能感动。',
    love: '彼此信任，心心相印。',
    strategy: '“议狱缓死”。诚信的人在处理刑罚时也会心存仁厚。做人要像空心的芦苇一样虚心，才能承载诚信。'
  },
  '001100': {
    name: '雷山小过',
    desc: '行过乎恭，丧过乎哀。',
    overview: '中下卦。小过，小有过度。飞鸟遗之音，不宜上宜下。',
    career: '可以做小事，不能做大事。由于能力不足，容易出现小的偏差。',
    love: '由于琐事产生小的摩擦。要互相包容。',
    strategy: '“行过乎恭”。宁可过于恭敬，也不要傲慢；宁可过于节俭，也不要奢侈。在小事上稍微过度一点（矫枉过正）是可以的。'
  },
  '010101': {
    name: '水火既济',
    desc: '初吉终乱，思患预防。',
    overview: '中上卦。既济，事已成。水火既济，阴阳正配。完美的状态，但也是衰乱的开始。',
    career: '目标达成，功成名就。但要小心“盛极而衰”，不要因为成功而懈怠。',
    love: '终成眷属，美满幸福。',
    strategy: '“思患而预防之”。在成功的时候，要想到未来可能发生的祸患。守成比创业更难，要战战兢兢，如履薄冰。'
  },
  '101010': {
    name: '火水未济',
    desc: '辨物居方，慎终如始。',
    overview: '中下卦。未济，事未成。水火不交，阴阳失位。但由于未完成，所以充满希望。',
    career: '事情尚未成功，还需要继续努力。虽然现在困难，但只要坚持下去，前途无量。',
    love: '尚未修成正果，由于性格差异大，需要磨合。',
    strategy: '“君子以慎辨物居方”。因为没有完成，所以有无限可能。要各归其位，重新调整，为了下一次的成功做准备。易经以未济卦结束，代表生生不息。'
  }
};

export const getHexagramData = (binaryString: string): HexagramData => {
  const data = HEXAGRAM_MAP[binaryString];
  
  // Generate line interpretations dynamically based on the binary string
  // Binary string index 0 is Bottom line (Position 1), index 5 is Top line (Position 6)
  const lines: LineInterpretation[] = [];
  for (let i = 0; i < 6; i++) {
    const isYang = binaryString[i] === '1';
    const position = i + 1; // 1-based index
    const lineName = getLineName(position, isYang);
    const { positionDesc, advice } = getGeneralLineText(position, isYang, data ? data.name : '未知');
    
    lines.push({
      name: lineName,
      positionDesc,
      advice
    });
  }

  // Fallback for unknown binary
  if (!data) {
    return {
      code: binaryString,
      name: '未知卦',
      pinyin: 'Wei Zhi',
      description: '卦象计算异常',
      overview: '数据缺失',
      career: '暂无',
      love: '暂无',
      strategy: '暂无',
      lines: lines
    };
  }

  return {
    code: binaryString,
    name: data.name,
    pinyin: '', // Optional, removed from raw map to save space
    description: data.desc,
    overview: data.overview,
    career: data.career,
    love: data.love,
    strategy: data.strategy,
    lines: lines
  };
};